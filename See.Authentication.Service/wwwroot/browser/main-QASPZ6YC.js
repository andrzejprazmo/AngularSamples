import{a as s,b as G,c as m}from"./chunk-G6XNAQK2.js";import{c as M,f as b,g as y,h as H,i as R,j as p,l as j}from"./chunk-V2JAHVB4.js";import{Ja as T,K as C,Ka as h,La as S,Oa as x,Sa as E,V as e,X as A,c as d,ea as w,m as v,n as u,q as g,r as k,z as c}from"./chunk-2DWBKVJN.js";var D=(t,r)=>{let n=e(p);return r.url==="/"&&n.navigate(["/dashboard/home"]),!0};var l=(t,r)=>d(void 0,null,function*(){let n=e(m),i=e(p),o=e(s),a=n.getToken();return a?o.isTokenExpired(a)?yield g(n.refreshToken().pipe(k(f=>!0),c(f=>f.status===401?(n.removeToken(),i.navigate(["/account/login"]),v(!1)):u(()=>f)))):!0:(i.navigate(["/account/login"]),!1)});var F=[{path:"",loadComponent:()=>import("./chunk-4DLYGSHO.js"),children:[{path:"dashboard",loadChildren:()=>import("./chunk-IZVFD6OJ.js"),canActivate:[l]},{path:"features",loadChildren:()=>import("./chunk-LQQTQT7L.js"),canActivate:[l]}],canActivate:[D]},{path:"",loadComponent:()=>import("./chunk-HMMXRAWL.js"),children:[{path:"account",loadChildren:()=>import("./chunk-CLHCNG4A.js")}]},{path:"",redirectTo:"dashboard/home",pathMatch:"full"},{path:"**",loadComponent:()=>import("./chunk-YW3HSEAW.js")}];var I=(t,r)=>{let n=e(m),i=e(s),o=t.url.includes("api/auth/refresh-token"),a=n.getToken();return a?i.isTokenExpired(a)&&!o?O(t,r):r(J(t,a)):r(t)};function J(t,r){return t.clone({headers:t.headers.set("Authorization",`Bearer ${r}`)})}function O(t,r){let n=e(m),i=e(p);return n.refreshToken().pipe(C(o=>r(J(t,o.token))),c(o=>o.status===401?(n.removeToken(),i.navigate(["/account/login"]),r(t)):u(()=>o)))}var z={providers:[j(F),w(G.forRoot({config:{tokenGetter:()=>sessionStorage.getItem("auth-token")}})),b(y([I]))]};var B=(()=>{let r=class r{constructor(){this.title="DumbApp"}};r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=A({type:r,selectors:[["app-root"]],standalone:!0,features:[E],decls:5,vars:0,consts:[[1,"container"]],template:function(o,a){o&1&&(T(0,"div",0)(1,"h2"),x(2,"Angular Dumb App"),h(),S(3,"hr")(4,"router-outlet"),h())},dependencies:[M,R]});let t=r;return t})();H(B,z).catch(t=>console.error(t));
